!function n(s,o,r){function a(t,e){if(!o[t]){if(!s[t]){var i="function"==typeof require&&require;if(!e&&i)return i(t,!0);if(c)return c(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}i=o[t]={exports:{}},s[t][0].call(i.exports,function(e){return a(s[t][1][e]||e)},i,i.exports,n,s,o,r)}return o[t].exports}for(var c="function"==typeof require&&require,e=0;e<r.length;e++)a(r[e]);return a}({1:[function(e,t,i){t.exports=msgpack},{}],2:[function(e,t,i){"use strict";var n,s;Object.defineProperty(i,"__esModule",{value:!0}),i.CommonNumber=i.CommonAngle=void 0,(s=n=i.CommonAngle||(i.CommonAngle={}))[s.PI_FOUR=Math.PI/4]="PI_FOUR",s[s.PI_TWO=Math.PI/2]="PI_TWO",(s=i.CommonNumber||(i.CommonNumber={}))[s.SIN45=Math.sin(n.PI_FOUR)]="SIN45"},{}],3:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.getObjects=i.getEntities=i.getPlayer=i.getSize=i.getId=void 0;const n=e("msgpack-lite");var s,o,r,a=e("./renderer");const c=e("./store/entities"),u=e("./store/objects"),l=e("./types/packets"),d=((0,a.animate)(),new WebSocket("ws://localhost:8080"));d.binaryType="arraybuffer";var h=[],f=[];i.getId=function(){return s},i.getSize=function(){return o},i.getPlayer=function(){return r},i.getEntities=function(){return h};var p=!(i.getObjects=function(){return f});d.onmessage=e=>{e=(0,n.decode)(new Uint8Array(e.data));s=e.id,o=e.size,d.send((0,n.encode)({id:s}).buffer),p=!0;const t=setInterval(()=>{p?d.send((0,n.encode)(new l.PingPacket).buffer):clearInterval(t)},1e3);d.onmessage=e=>{var t=(0,n.decode)(new Uint8Array(e.data));switch(t.type){case"game":var i=t;h=i.entities.map(e=>(0,c.castCorrectEntity)(e)),f=i.objects.map(e=>(0,u.castCorrectObject)(e)),r=new c.Player(i.player);break;case"map":}}},d.onclose=()=>p=!1;const m=["d","w","a","s"],y=[!1,!1,!1,!1];window.onkeydown=e=>{p&&0<=(e=m.indexOf(e.key))&&!y[e]&&(d.send((0,n.encode)(new l.MovementPressPacket(e)).buffer),y[e]=!0)},window.onkeyup=e=>{p&&0<=(e=m.indexOf(e.key))&&(d.send((0,n.encode)(new l.MovementReleasePacket(e)).buffer),y[e]=!1)},window.onmousemove=e=>{p&&d.send((0,n.encode)(new l.MouseMovePacket(e.x-window.innerWidth/2,e.y-window.innerHeight/2)).buffer)},window.onmousedown=e=>{p&&d.send((0,n.encode)(new l.MousePressPacket(e.button)))},window.onmouseup=e=>{p&&d.send((0,n.encode)(new l.MouseReleasePacket(e.button)))}},{"./renderer":4,"./store/entities":9,"./store/objects":12,"./types/packets":20,"msgpack-lite":1}],4:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.animate=void 0;const s=e("./game"),o=e("./rendering/hud"),r=e("./utils"),a=document.getElementById("game"),c=(a.width=window.innerWidth,a.height=window.innerHeight,window.onresize=()=>{a.width=window.innerWidth,a.height=window.innerHeight},a.getContext("2d"));i.animate=function e(){try{c.fillStyle="#80B251",c.fillRect(0,0,a.width,a.height);const i=(0,s.getPlayer)();if(i){console.log("drawing");const n=Math.max(a.width,a.height)/(40*i.scope);c.strokeStyle="#000000",c.lineWidth=a.width/200;var t=(0,s.getSize)();c.strokeRect(a.width/2-(i.position.x+i.hitbox.comparable())*n,a.height/2-(i.position.y+i.hitbox.comparable())*n,(t[0]+2*i.hitbox.comparable())*n,(t[1]+2*i.hitbox.comparable())*n),c.lineWidth/=2,c.globalAlpha=.2;for(let e=0;e<=t[0];e+=20)(0,r.lineBetween)(c,a.width/2-(i.position.x-e)*n,0,a.width/2-(i.position.x-e)*n,a.height);for(let e=0;e<=t[1];e+=20)(0,r.lineBetween)(c,0,a.height/2-(i.position.y-e)*n,a.width,a.height/2-(i.position.y-e)*n);c.globalAlpha=1,i.render(i,a,c,n),(0,s.getEntities)().forEach(e=>{e.render(i,a,c,n)}),(0,s.getObjects)().forEach(e=>{e.render(i,a,c,n)}),(0,o.drawHealth)(i,a,c)}}catch(e){console.error(e)}requestAnimationFrame(e)}},{"./game":3,"./rendering/hud":5,"./utils":22}],5:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.drawHealth=void 0;const c=e("../utils");i.drawHealth=function(e,t,i){var n=t.width/4,s=t.height/20,o=Math.min(t.width,t.height)/100,r=n-2*o,a=s-2*o;i.fillStyle="#000000",i.globalAlpha=.2,(0,c.roundRect)(i,(t.width-n)/2,t.height-s-o,n,s,o/2),e.health==e.maxHealth?i.fillStyle="#ccc":e.health/e.maxHealth<.8?i.fillStyle="#fdd":e.health/e.maxHealth<.25?i.fillStyle="#daa":i.fillStyle="#fff",i.globalAlpha=1,(0,c.roundRect)(i,(t.width-r)/2,t.height-s,r*e.health/e.maxHealth,a,o/2)}},{"../utils":22}],6:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../types/animations"),e=e("../../types/maths");const s=new n.DefinedAnimation("left_fist",[new e.Vec2(0,-1),e.Vec2.ONE,new e.Vec2(0,-1)],Array(3).fill(e.Vec2.ZERO),[0,.5,1],50),o=new n.DefinedAnimation("right_fist",[new e.Vec2(0,1),e.Vec2.ONE,new e.Vec2(0,1)],Array(3).fill(e.Vec2.ZERO),[0,.5,1],50);i.default=function(e){e.set(s.id,s),e.set(o.id,o)}},{"../../types/animations":16,"../../types/maths":18}],7:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.animations=void 0;e=e("./fists");i.animations=new Map,(0,e.default)(i.animations)},{"./fists":6}],8:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});class n extends e("../../types/entities").Entity{constructor(e){super(e),this.type="bullet",this.dmg=e.dmg}}i.default=n},{"../../types/entities":17}],9:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.castCorrectEntity=i.Bullet=i.Player=void 0;const n=e("../../types/entities"),s=e("./bullet"),o=e("./player");var r=e("./player"),a=(Object.defineProperty(i,"Player",{enumerable:!0,get:function(){return r.default}}),e("./bullet"));Object.defineProperty(i,"Bullet",{enumerable:!0,get:function(){return a.default}}),i.castCorrectEntity=function(e){switch(e.type){case"player":return new o.default(e);case"bullet":return new s.default(e);default:return new n.Entity(e)}}},{"../../types/entities":17,"./bullet":8,"./player":10}],10:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../types/entities");const o=e("../../utils"),r=e("../weapons");class s extends n.Entity{constructor(e){super(e),this.type="player",this.id=e.id,this.boost=e.boost,this.scope=e.scope,this.inventory=e.inventory}render(e,t,i,n){var e=this.position.addVec(e.position.inverse()),s=n*this.hitbox.radius;i.fillStyle="#F8C675",(0,o.circleFromCenter)(i,t.width/2+e.x*n,t.height/2+e.y*n,s),this.inventory.holding||new r.Fists}}i.default=s},{"../../types/entities":17,"../../utils":22,"../weapons":15}],11:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});e=e("../../types/objects");const a=Object.assign(new Image,{loaded:!1});a.onload=()=>a.loaded=!0,a.src="assets/images/Bush.png";class n extends e.GameObject{constructor(){super(...arguments),this.type="bush"}render(e,t,i,n){var s,o,r;a.loaded&&(e=this.position.addVec(e.position.inverse()),o=(s=n*this.hitbox.comparable()*3)*a.naturalWidth/a.naturalHeight,r=(t.width-s)/4+e.x*n,t=(t.height-o)/4+e.y*n,i.drawImage(a,r,t,s,o))}}i.default=n},{"../../types/objects":19}],12:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.castCorrectObject=i.Bush=i.Tree=void 0;const n=e("../../types/objects"),s=e("./bush"),o=e("./tree");var r=e("./tree"),a=(Object.defineProperty(i,"Tree",{enumerable:!0,get:function(){return r.default}}),e("./bush"));Object.defineProperty(i,"Bush",{enumerable:!0,get:function(){return a.default}}),i.castCorrectObject=function(e){switch(e.type){case"tree":return new o.default(e);case"bush":return new s.default(e);default:return new n.GameObject(e)}}},{"../../types/objects":19,"./bush":11,"./tree":13}],13:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});e=e("../../types/objects");const a=Object.assign(new Image,{loaded:!1});a.onload=()=>a.loaded=!0,a.src="assets/images/tree.svg";class n extends e.GameObject{constructor(){super(...arguments),this.type="tree"}render(e,t,i,n){var s,o,r;a.loaded&&(e=this.position.addVec(e.position.inverse()),o=(s=n*this.hitbox.comparable()*10)*a.naturalWidth/a.naturalHeight,r=(t.width-s)/2+e.x*n,t=(t.height-o)/2+e.y*n,i.drawImage(a,r,t,s,o))}}i.default=n},{"../../types/objects":19}],14:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const p=e("../../constants"),m=e("../../types/maths");var n=e("../../types/weapons");const y=e("../../utils"),b=e("../animations"),g=["left_fist","right_fist"];class s extends n.Weapon{constructor(){super({id:"fists",name:"Fists"})}render(t,e,i,n,s){var s=s*t.hitbox.radius,o=1.2*s*p.CommonNumber.SIN45,r=m.Vec2.ONE.scaleAll(o),a=[],c=b.animations.get(t.animation.name);if(c){var u=g.indexOf(t.animation.name),l=(c.duration-t.animation.duration)/c.duration;for(let e=0;e<c.keyframes.length-1;e++)if(l>=c.keyframes[e]&&l<=c.keyframes[e+1]){var d=c.positions[e].addVec(c.positions[e+1].addVec(c.positions[e].inverse()).scaleAll((l-c.keyframes[e])/(c.keyframes[e+1]-c.keyframes[e]))).scaleAll(o);console.log(d),a.push(r.addVec(d).addAngle(t.direction.angle()));break}a.push(r.addVec(r.addAngle(p.CommonAngle.PI_TWO*(2*-u+1))).addAngle(t.direction.angle()))}else a.push(r.addVec(r.addAngle(p.CommonAngle.PI_TWO)).addAngle(t.direction.angle())),a.push(r.addVec(r.addAngle(-p.CommonAngle.PI_TWO)).addAngle(t.direction.angle()));var h=s/3;n.lineWidth=h/3,n.strokeStyle="#000000";for(const f of a)(0,y.circleFromCenter)(n,i.width/2+e.x*o+f.x,i.height/2+e.y*o+f.y,h,!0,!0)}}i.default=s},{"../../constants":2,"../../types/maths":18,"../../types/weapons":21,"../../utils":22,"../animations":7}],15:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.castCorrectWeapon=i.Fists=void 0;const n=e("../../types/weapons"),s=e("./fists");var o=e("./fists");Object.defineProperty(i,"Fists",{enumerable:!0,get:function(){return o.default}}),i.castCorrectWeapon=function(e){return"fists"!==e.id?new n.Weapon(e):new s.default}},{"../../types/weapons":21,"./fists":14}],16:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.DefinedAnimation=void 0;i.DefinedAnimation=class{constructor(e,t,i,n,s){this.id=e,this.positions=t,this.rotations=i,this.keyframes=n,this.duration=s}}},{}],17:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Entity=i.Inventory=void 0;const n=e("../store/weapons"),s=e("./maths");i.Inventory=class{constructor(e){this.holding=(0,n.castCorrectWeapon)(e.holding)}};i.Entity=class{constructor(e){var t;this.type=e.type,this.position=new s.Vec2(e.position.x,e.position.y),this.direction=new s.Vec2(e.direction.x,e.direction.y),"rect"===e.hitbox.type?(t=e.hitbox,this.hitbox=new s.RectHitbox(t.width,t.height)):(t=e.hitbox,this.hitbox=new s.CircleHitbox(t.radius)),this.animation=e.animation,this.health=this.maxHealth=100}render(e,t,i,n){}}},{"../store/weapons":15,"./maths":18}],18:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.MovementDirection=i.CircleHitbox=i.RectHitbox=i.Vec2=void 0;class n{constructor(e,t){this.x=e,this.y=t}magnitudeSqr(){return this.x*this.x+this.y*this.y}magnitude(){return Math.sqrt(this.magnitudeSqr())}inverse(){return new n(-this.x,-this.y)}unit(){var e=this.magnitude();return 0===e?n.ZERO:new n(this.x/e,this.y/e)}dot(e){return this.x*e.x+this.y*e.y}angleBetween(e){return Math.acos(this.dot(e)/(this.magnitude()*e.magnitude()))}angle(){var e=Math.acos(this.x/this.magnitude());return 0<this.y?e:-e}addAngle(e){var e=this.angle()+e,t=this.magnitude();return new n(t*Math.cos(e),t*Math.sin(e))}addVec(e){return new n(this.x+e.x,this.y+e.y)}addX(e){return new n(this.x+e,this.y)}addY(e){return new n(this.x,this.y+e)}scale(e,t){return new n(this.x*e,this.y*t)}scaleAll(e){return this.scale(e,e)}}(i.Vec2=n).ZERO=new n(0,0),n.ONE=new n(1,0);class s{constructor(e,t){this.type="rect",this.width=e,this.height=t}comparable(){return this.width}}(i.RectHitbox=s).ZERO=new s(0,0);class o{constructor(e){this.type="circle",this.radius=e}comparable(){return this.radius}}(i.CircleHitbox=o).ZERO=new o(0),(i=i.MovementDirection||(i.MovementDirection={}))[i.RIGHT=0]="RIGHT",i[i.UP=1]="UP",i[i.LEFT=2]="LEFT",i[i.DOWN=3]="DOWN"},{}],19:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.GameObject=void 0;const n=e("./maths");i.GameObject=class{constructor(e){var t;this.type="",this.type=e.type,this.position=new n.Vec2(e.position.x,e.position.y),"rect"===e.hitbox.type?(t=e.hitbox,this.hitbox=new n.RectHitbox(t.width,t.height)):(t=e.hitbox,this.hitbox=new n.CircleHitbox(t.radius))}render(e,t,i,n){}}},{"./maths":18}],20:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.MapPacket=i.GamePacket=i.MouseMovePacket=i.MouseReleasePacket=i.MousePressPacket=i.MovementReleasePacket=i.MovementPressPacket=i.PingPacket=void 0;i.PingPacket=class{constructor(){this.type="ping"}};i.MovementPressPacket=class{constructor(e){this.type="movementpress",this.direction=e}};i.MovementReleasePacket=class{constructor(e){this.type="movementrelease",this.direction=e}};i.MousePressPacket=class{constructor(e){this.type="mousepress",this.button=e}};i.MouseReleasePacket=class{constructor(e){this.type="mouserelease",this.button=e}};i.MouseMovePacket=class{constructor(e,t){this.type="mousemove",this.x=e,this.y=t}};i.GamePacket=class{constructor(){this.type="game"}};i.MapPacket=class{constructor(){this.type="map"}}},{}],21:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Weapon=void 0;i.Weapon=class{constructor(e){this.id=e.id,this.name=e.name}render(e,t,i,n,s){}}},{}],22:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.toDegrees=i.roundRect=i.lineBetween=i.circleFromCenter=i.circle=i.clamp=i.wait=void 0,i.wait=function(t){return new Promise(e=>setTimeout(e,t))},i.clamp=function(e,t,i){return e<t?t:i<e?i:e},i.circle=function(e,t,i,n,s=!0,o=!1){e.beginPath(),e.arc(t+n,i+n,n,0,2*Math.PI,!1),s&&e.fill(),o&&e.stroke()},i.circleFromCenter=function(e,t,i,n,s=!0,o=!1){e.beginPath(),e.arc(t,i,n,0,2*Math.PI,!1),s&&e.fill(),o&&e.stroke()},i.lineBetween=function(e,t,i,n,s,o=!0){e.beginPath(),e.moveTo(t,i),e.lineTo(n,s),e.closePath(),o&&e.stroke()},i.roundRect=function(e,t,i,n,s,o,r=!0,a=!1){var c,u,l,d;"number"==typeof(o=void 0===o?5:o)?c=u=l=d=o:(c=o.tl||0,u=o.tr||0,d=o.br||0,l=o.bl||0),e.beginPath(),e.moveTo(t+c,i),e.lineTo(t+n-u,i),e.quadraticCurveTo(t+n,i,t+n,i+u),e.lineTo(t+n,i+s-d),e.quadraticCurveTo(t+n,i+s,t+n-d,i+s),e.lineTo(t+l,i+s),e.quadraticCurveTo(t,i+s,t,i+s-l),e.lineTo(t,i+c),e.quadraticCurveTo(t,i,t+c,i),e.closePath(),r&&e.fill(),a&&e.stroke()},i.toDegrees=function(e){return 180*e/Math.PI}},{}]},{},[3]);