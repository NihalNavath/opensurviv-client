!function i(s,r,o){function a(t,e){if(!r[t]){if(!s[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(d)return d(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}n=r[t]={exports:{}},s[t][0].call(n.exports,function(e){return a(s[t][1][e]||e)},n,n.exports,i,s,r,o)}return r[t].exports}for(var d="function"==typeof require&&require,e=0;e<o.length;e++)a(o[e]);return a}({1:[function(e,t,n){t.exports=msgpack},{}],2:[function(e,t,n){"use strict";var i,s;Object.defineProperty(n,"__esModule",{value:!0}),n.MINIMAP_SIZE=n.GRID_INTERVAL=n.movementKeys=n.KeyBind=n.CommonNumber=n.CommonAngle=void 0,(i=s=n.CommonAngle||(n.CommonAngle={}))[i.PI_FOUR=Math.PI/4]="PI_FOUR",i[i.PI_TWO=Math.PI/2]="PI_TWO",(i=n.CommonNumber||(n.CommonNumber={}))[i.SIN45=Math.sin(s.PI_FOUR)]="SIN45",(s=i=n.KeyBind||(n.KeyBind={})).MENU="Escape",s.HIDE_HUD="F1",s.WORLD_MAP="g",s.HIDE_MAP="z",s.BIG_MAP="v",s.RIGHT="d",s.UP="w",s.LEFT="a",s.DOWN="s",n.movementKeys=[i.RIGHT,i.UP,i.LEFT,i.DOWN].map(e=>e),n.GRID_INTERVAL=20,n.MINIMAP_SIZE=100},{}],3:[function(e,t,o){"use strict";var n,i,a,s;Object.defineProperty(o,"__esModule",{value:!0}),o.getPlayer=o.getId=o.world=void 0;const d=e("msgpack-lite"),r=e("./constants"),c=e("./renderer"),l=e("./rendering/map"),u=e("./states"),h=e("./store/entities"),p=e("./store/obstacles"),y=e("./store/terrains"),m=e("./types/math"),f=e("./types/packet"),g=e("./types/terrain");o.world=new g.World,o.getId=function(){return n};var w=!(o.getPlayer=function(){return a});null!=(e=document.getElementById("connect"))&&e.addEventListener("click",()=>{var e;i=document.getElementById("username").value,e=document.getElementById("address").value,(s=new WebSocket("ws://"+e)).binaryType="arraybuffer",s.onmessage=e=>{var e=(0,d.decode)(new Uint8Array(e.data));n=e.id,o.world=new g.World(new m.Vec2(e.size[0],e.size[1]),(0,y.castCorrectTerrain)(e.terrain)),s.send((0,d.encode)({username:i,id:n}).buffer),w=!0,(0,c.setRunning)(!0),(0,c.animate)(),null!=(e=document.getElementById("menu"))&&e.classList.add("hidden");const t=setInterval(()=>{w?s.send((0,d.encode)(new f.PingPacket).buffer):clearInterval(t)},1e3);s.onmessage=e=>{var t=(0,d.decode)(new Uint8Array(e.data));switch(t.type){case"game":var n=t;o.world.entities=n.entities.map(e=>(0,h.castCorrectEntity)(e)),o.world.obstacles=n.obstacles.map(e=>(0,p.castCorrectObstacle)(e)),a=new h.Player(n.player);break;case"map":n=t;(0,l.initMap)();const i=(0,l.getMapCanvas)(),s=(0,l.getMapCtx)(),r=i.width/o.world.size.x;o.world.terrains=n.terrains.map(e=>(0,y.castCorrectTerrain)(e)),o.world.terrains.filter(e=>!!e.renderMapLayerN1).forEach(e=>e.renderMapLayerN1(i,s,r)),o.world.terrains.forEach(e=>e.renderMap(i,s,r));n=n.obstacles.map(e=>(0,p.castCorrectObstacle)((0,p.castMinObstacle)(e))).sort((e,t)=>e.zIndex-t.zIndex);n.filter(e=>!!e.renderMapLayerN1).forEach(e=>e.renderMapLayerN1(i,s,r)),n.forEach(e=>e.renderMap(i,s,r))}}},s.onclose=()=>{var e;(w=!1,c.setRunning)(!1),null!=(e=document.getElementById("menu"))&&e.classList.remove("hidden"),a=i=n=null,o.world=new g.World}}),null!=(e=document.getElementById("disconnect"))&&e.addEventListener("click",()=>{var e;s.close(),null!=(e=document.getElementById("settings"))&&e.classList.add("hidden"),(0,u.toggleMenu)()}),window.onkeydown=e=>{var t,n;w&&!(0,u.isKeyPressed)(e.key)&&(e.stopPropagation(),(0,u.addKeyPressed)(e.key),t=document.getElementById("settings"),e.key==r.KeyBind.MENU?((0,u.isMenuHidden)()?null!=t&&t.classList.remove("hidden"):null!=t&&t.classList.add("hideen"),(0,u.toggleMenu)()):e.key==r.KeyBind.HIDE_HUD?(0,u.toggleHud)():e.key==r.KeyBind.WORLD_MAP?(0,u.toggleMap)():e.key==r.KeyBind.HIDE_MAP?(0,u.toggleMinimap)():e.key==r.KeyBind.BIG_MAP&&(0,u.toggleBigMap)(),(0,u.isMenuHidden)())&&0<=(n=r.movementKeys.indexOf(e.key))&&s.send((0,d.encode)(new f.MovementPressPacket(n)).buffer)},window.onkeyup=e=>{w&&(e.stopPropagation(),(0,u.removeKeyPressed)(e.key),0<=(e=r.movementKeys.indexOf(e.key)))&&s.send((0,d.encode)(new f.MovementReleasePacket(e)).buffer)},window.onmousemove=e=>{w&&(e.stopPropagation(),s.send((0,d.encode)(new f.MouseMovePacket(e.x-window.innerWidth/2,e.y-window.innerHeight/2)).buffer))},window.onmousedown=e=>{w&&(e.stopPropagation(),(0,u.addMousePressed)(e.button),s.send((0,d.encode)(new f.MousePressPacket(e.button))))},window.onmouseup=e=>{w&&(e.stopPropagation(),(0,u.removeMousePressed)(e.button),s.send((0,d.encode)(new f.MouseReleasePacket(e.button))))}},{"./constants":2,"./renderer":4,"./rendering/map":6,"./states":7,"./store/entities":12,"./store/obstacles":16,"./store/terrains":18,"./types/math":25,"./types/packet":27,"./types/terrain":28,"msgpack-lite":1}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.animate=n.setRunning=void 0;const c=e("./constants"),l=e("./game"),u=e("./rendering/hud"),h=e("./rendering/map"),p=e("./states"),y=e("./utils"),m=document.getElementById("game");m.width=window.innerWidth,m.height=window.innerHeight;var f=!(window.onresize=()=>{m.width=window.innerWidth,m.height=window.innerHeight});n.setRunning=function(e){f=e};const g=m.getContext("2d");n.animate=function e(){try{g.fillStyle=l.world.defaultTerrain.colorToHex(),g.fillRect(0,0,m.width,m.height);const a=(0,l.getPlayer)();if(a){const d=Math.max(m.width,m.height)/(20+20*a.scope);var t=l.world.size,n=m.width/2-a.position.x*d,i=m.height/2-a.position.y*d,s=t.x*d,r=t.y*d;g.strokeStyle="#000000",g.lineWidth=d/4,g.strokeRect(n,i,s,r),g.globalAlpha=.2;for(let e=0;e<=t.x;e+=c.GRID_INTERVAL)(0,y.lineBetween)(g,m.width/2-(a.position.x-e)*d,Math.max(i,0),m.width/2-(a.position.x-e)*d,Math.min(i+r,m.height));for(let e=0;e<=t.y;e+=c.GRID_INTERVAL)(0,y.lineBetween)(g,Math.max(n,0),m.height/2-(a.position.y-e)*d,Math.min(n+s,m.width),m.height/2-(a.position.y-e)*d);g.globalAlpha=1,l.world.terrains.filter(e=>!!e.renderLayerN1).forEach(e=>e.renderLayerN1(a,m,g,d)),l.world.terrains.forEach(e=>e.render(a,m,g,d));var o=[];(o=o.concat(l.world.entities,l.world.obstacles)).push(a),(o=o.sort((e,t)=>e.zIndex-t.zIndex)).filter(e=>!!e.renderLayerN1).forEach(e=>e.renderLayerN1(a,m,g,d)),o.forEach(e=>e.render(a,m,g,d)),(0,p.isHudHidden)()||(0,u.drawHud)(a,m,g),(0,p.isMapOpened)()?(0,h.drawMap)(m,g):(0,p.isMapHidden)()||(0,h.drawMinimap)(a,m,g)}}catch(e){console.error(e)}f&&requestAnimationFrame(e)}},{"./constants":2,"./game":3,"./rendering/hud":5,"./rendering/map":6,"./states":7,"./utils":30}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.drawHud=void 0;const d=e("../utils");n.drawHud=function(e,t,n){var i=t.width/4,s=t.height/20,r=Math.min(t.width,t.height)/100,o=i-2*r,a=s-2*r;n.fillStyle="#000000",n.globalAlpha=.2,(0,d.roundRect)(n,(t.width-i)/2,t.height-s-r,i,s,r/2),e.health==e.maxHealth?n.fillStyle="#ccc":e.health/e.maxHealth<.8?n.fillStyle="#fdd":e.health/e.maxHealth<.25?n.fillStyle="#daa":n.fillStyle="#fff",n.globalAlpha=1,(0,d.roundRect)(n,(t.width-o)/2,t.height-s,o*e.health/e.maxHealth,a,r/2)}},{"../utils":30}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.drawMinimap=n.drawMap=n.initMap=n.getMapCtx=n.getMapCanvas=void 0;const r=e("../constants"),o=e("../game"),a=e("../states"),d=e("../utils"),c=document.createElement("canvas");var l,u;const h=document.createElement("canvas");n.getMapCanvas=function(){return c},n.getMapCtx=function(){return l},n.initMap=function(){var t=o.world.size,n=Math.max(t.x,t.y),i=Math.min(window.screen.availWidth,window.screen.availHeight);c.width=i*t.x/n,c.height=i*t.y/n,u=i/n,(l=c.getContext("2d")).fillStyle=o.world.defaultTerrain.colorToHex(),l.fillRect(0,0,c.width,c.height),l.strokeStyle="#000000",l.lineWidth=1,l.globalAlpha=.2;for(let e=0;e<=t.x;e+=r.GRID_INTERVAL)(0,d.lineBetween)(l,e*i/n,0,e*i/n,c.height);for(let e=0;e<=t.y;e+=r.GRID_INTERVAL)(0,d.lineBetween)(l,0,e*i/n,c.width,e*i/n);l.globalAlpha=1},n.drawMap=function(e,t){var n,i,s=e.width/c.width,s=(r=e.height/c.height)*c.width>e.width?(n=e.width,i=s*c.height,e.width/o.world.size.x):(n=r*c.width,i=e.height,e.height/o.world.size.y),r=(t.drawImage(c,(e.width-n)/2,(e.height-i)/2,n,i),t.strokeStyle="#000",t.lineWidth=2,t.strokeRect((e.width-n)/2,(e.height-i)/2,n,i),(0,o.getPlayer)());t.fillStyle="#F8C675",(0,d.circleFromCenter)(t,(e.width-n)/2+r.position.x*s,(e.height-i)/2+r.position.y*s,8),(0,d.circleFromCenter)(t,(e.width-n)/2+r.position.x*s,(e.height-i)/2+r.position.y*s,12,!1,!0)},n.drawMinimap=function(e,t,n){var i=r.MINIMAP_SIZE*u*((0,a.isBigMap)()?1.5:1),s=e.position.x*u-i/2,e=e.position.y*u-i/2,s=l.getImageData(s,e,i,i),i=(h.width=h.height=i,null!=(e=h.getContext("2d"))&&e.putImageData(s,0,0),t.width/100),e=t.width/(8/((0,a.isBigMap)()?1.5:1));n.fillStyle=o.world.defaultTerrain.colorToHex(),n.fillRect(i,t.height-i-e,e,e),n.drawImage(h,i,t.height-i-e,e,e),n.strokeStyle="#000",n.lineWidth=2,n.strokeRect(i,t.height-i-e,e,e),n.fillStyle="#F8C675",(0,d.circleFromCenter)(n,i+e/2,t.height-i-e/2,8),(0,d.circleFromCenter)(n,i+e/2,t.height-i-e/2,12,!1,!0)}},{"../constants":2,"../game":3,"../states":7,"../utils":30}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.toggleBigMap=n.isBigMap=n.toggleMinimap=n.isMapHidden=n.toggleMap=n.isMapOpened=n.toggleHud=n.isHudHidden=n.toggleMenu=n.isMenuHidden=n.removeMousePressed=n.addMousePressed=n.isMousePressed=n.removeKeyPressed=n.addKeyPressed=n.isKeyPressed=void 0;const i=new Map;n.isKeyPressed=function(e){return!!i.get(e)},n.addKeyPressed=function(e){i.set(e,!0)},n.removeKeyPressed=function(e){i.delete(e)};const s=new Map;n.isMousePressed=function(e){return!!s.get(e)},n.addMousePressed=function(e){s.set(e,!0)},n.removeMousePressed=function(e){s.delete(e)};var r=!0;n.isMenuHidden=function(){return r};var o=!(n.toggleMenu=function(){r=!r});n.isHudHidden=function(){return o};var a=!(n.toggleHud=function(){o=!o});n.isMapOpened=function(){return a};var d=!(n.toggleMap=function(){a=!a});n.isMapHidden=function(){return d};var c=!(n.toggleMinimap=function(){d=!d});n.isBigMap=function(){return c},n.toggleBigMap=function(){c=!c}},{}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e("../../types/animation"),e=e("../../types/math");const s=new i.DefinedAnimation("left_fist",[new e.Vec2(0,-1),e.Vec2.ONE,new e.Vec2(0,-1)],Array(3).fill(e.Vec2.ZERO),[0,.5,1],50),r=new i.DefinedAnimation("right_fist",[new e.Vec2(0,1),e.Vec2.ONE,new e.Vec2(0,1)],Array(3).fill(e.Vec2.ZERO),[0,.5,1],50);n.default=function(e){e.set(s.id,s),e.set(r.id,r)}},{"../../types/animation":23,"../../types/math":25}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.animations=void 0;e=e("./fists");n.animations=new Map,(0,e.default)(n.animations)},{"./fists":8}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});class i extends e("../../types/entity").Entity{constructor(e){super(e),this.type="bullet",this.dmg=e.dmg}render(e,t,n,i){}}n.default=i},{"../../types/entity":24}],11:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.GunColor=void 0;var i=e("../../types/entity");const r=e("../../utils"),o=new Map,a=["#F2A500","#F20000","#0061F2","#039700"];(e=n.GunColor||(n.GunColor={}))[e.YELLOW=0]="YELLOW",e[e.RED=1]="RED",e[e.BLUE=2]="BLUE",e[e.GREEN=3]="GREEN";class s extends i.Entity{constructor(e){super(e),this.type="gun",this.zIndex=8,this.name=e.name,this.color=e.color}render(e,t,n,i){var e=this.position.addVec(e.position.inverse()),s=i*this.hitbox.comparable,t=(n.translate(t.width/2+e.x*i,t.height/2+e.y*i),n.rotate(-this.direction.angle()),n.strokeStyle=a[this.color],n.lineWidth=.25*i,(0,r.circleFromCenter)(n,0,0,s,!1,!0),n.fillStyle=a[this.color]+"66",(0,r.circleFromCenter)(n,0,0,s,!0,!1),o.get(this.name));t&&n.drawImage(t,-s,-s,2*s,2*s),n.resetTransform()}}n.default=s},{"../../types/entity":24,"../../utils":30}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.castCorrectEntity=n.Gun=n.Bullet=n.Player=void 0;const i=e("../../types/entity"),s=e("./bullet"),r=e("./gun"),o=e("./player");var a=e("./player"),d=(Object.defineProperty(n,"Player",{enumerable:!0,get:function(){return a.default}}),e("./bullet")),c=(Object.defineProperty(n,"Bullet",{enumerable:!0,get:function(){return d.default}}),e("./gun"));Object.defineProperty(n,"Gun",{enumerable:!0,get:function(){return c.default}}),n.castCorrectEntity=function(e){switch(e.type){case"player":return new o.default(e);case"bullet":return new s.default(e);case"gun":return new r.default(e);default:return new i.DummyEntity(e)}}},{"../../types/entity":24,"./bullet":10,"./gun":11,"./player":13}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const i=e("../../types/entity"),r=e("../../utils"),o=e("../weapons"),a=Object.assign(new Image,{loaded:!1});a.onload=()=>a.loaded=!0,a.src="assets/images/game/entities/death.svg";class s extends i.Entity{constructor(e){var t;super(e),this.type="player",this.zIndex=9,this.id=e.id,this.username=e.username,this.boost=e.boost,this.scope=e.scope,"number"==typeof e.inventory.holding?(t=e.inventory.weapons[e.inventory.holding],this.inventory=new i.Inventory({holding:t})):this.inventory=new i.Inventory(e.inventory)}render(e,t,n,i){var e=this.position.addVec(e.position.inverse()),s=i*this.hitbox.comparable;n.translate(t.width/2+e.x*i,t.height/2+e.y*i),this.despawn?(n.drawImage(a,2*-s,2*-s,4*s,4*s),n.textAlign="center",n.textBaseline="top",n.font=`700 ${i}px Jura`,n.fillStyle="#60605f",n.fillText(this.username,2,2*s+2),n.fillStyle="#80807f",n.fillText(this.username,0,2*s)):(n.rotate(-this.direction.angle()),n.fillStyle="#F8C675",(0,r.circleFromCenter)(n,0,0,s),(this.inventory.holding||new o.Fists).render(this,t,n,i)),n.resetTransform()}}n.default=s},{"../../types/entity":24,"../../utils":30,"../weapons":22}],14:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e("../../types/obstacle");const s=e("../../utils"),r=Object.assign(new Image,{loaded:!1}),o=(r.onload=()=>r.loaded=!0,r.src="assets/images/game/objects/bush.svg",Object.assign(new Image,{loaded:!1}));o.onload=()=>o.loaded=!0,o.src="assets/images/game/objects/residues/bush.svg";class a extends i.Obstacle{constructor(e){super(e),this.type="bush",this.zIndex=10,this.despawn&&(this.zIndex=0)}render(e,t,n,i){r.loaded&&o.loaded&&(e=this.position.addVec(e.position.inverse()),n.translate(t.width/2+e.x*i,t.height/2+e.y*i),n.rotate(-this.direction.angle()),t=this.despawn?o:r,i=(e=i*this.hitbox.comparable*2*(this.despawn?.5:1))*t.naturalWidth/t.naturalHeight,n.drawImage(t,-e/2,-i/2,e,i),n.resetTransform())}renderMap(e,t,n){t.fillStyle="#005f00",(0,s.circleFromCenter)(t,this.position.x*n,this.position.y*n,2*n)}}n.default=a},{"../../types/obstacle":26,"../../utils":30}],15:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});e=e("../../types/obstacle");const o=Object.assign(new Image,{loaded:!1}),a=(o.onload=()=>o.loaded=!0,o.src="assets/images/game/objects/crate.svg",Object.assign(new Image,{loaded:!1}));a.onload=()=>a.loaded=!0,a.src="assets/images/game/objects/residues/crate.svg";class i extends e.Obstacle{constructor(){super(...arguments),this.type="crate"}render(e,t,n,i){var s,r;o.loaded&&a.loaded&&(e=this.position.addVec(e.position.inverse()),r=(s=i*this.hitbox.width*(this.despawn?.5:1))*o.naturalWidth/o.naturalHeight,n.translate(t.width/2+e.x*i,t.height/2+e.y*i),n.rotate(-this.direction.angle()),n.drawImage(this.despawn?a:o,-s/2,-r/2,s,r),n.resetTransform())}renderMap(e,t,n){t.translate(this.position.x*n,this.position.y*n),t.fillStyle="#683c05",t.fillRect(-2*n,-2*n,4*n,4*n),t.resetTransform()}}n.default=i},{"../../types/obstacle":26}],16:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.castMinObstacle=n.castCorrectObstacle=n.Crate=n.Bush=n.Tree=void 0;const i=e("../../types/math"),s=e("../../types/obstacle"),r=e("./bush"),o=e("./crate"),a=e("./tree");var d=e("./tree"),c=(Object.defineProperty(n,"Tree",{enumerable:!0,get:function(){return d.default}}),e("./bush")),l=(Object.defineProperty(n,"Bush",{enumerable:!0,get:function(){return c.default}}),e("./crate"));Object.defineProperty(n,"Crate",{enumerable:!0,get:function(){return l.default}}),n.castCorrectObstacle=function(e){switch(e.type){case"tree":return new a.default(e);case"bush":return new r.default(e);case"crate":return new o.default(e);default:return new s.DummyObstacle(e)}},n.castMinObstacle=function(e){return Object.assign(e,{direction:i.Vec2.ONE,hitbox:new i.CircleHitbox(0),despawn:!1})}},{"../../types/math":25,"../../types/obstacle":26,"./bush":14,"./crate":15,"./tree":17}],17:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e("../../types/obstacle");const s=e("../../utils"),r=Object.assign(new Image,{loaded:!1}),o=(r.onload=()=>r.loaded=!0,r.src="assets/images/game/objects/tree.svg",Object.assign(new Image,{loaded:!1}));o.onload=()=>o.loaded=!0,o.src="assets/images/game/objects/residues/tree.svg";class a extends i.Obstacle{constructor(e){super(e),this.type="tree",this.zIndex=1e3,this.despawn&&(this.zIndex=0)}render(e,t,n,i){r.loaded&&o.loaded&&(e=this.position.addVec(e.position.inverse()),n.translate(t.width/2+e.x*i,t.height/2+e.y*i),n.rotate(-this.direction.angle()),t=this.despawn?o:r,i=(e=i*this.hitbox.comparable*2*(this.despawn?1:3.6))*t.naturalWidth/t.naturalHeight,n.drawImage(t,-e/2,-i/2,e,i),n.resetTransform())}renderMap(e,t,n){t.fillStyle="#3e502e",(0,s.circleFromCenter)(t,this.position.x*n,this.position.y*n,1.5*n*3.6)}}n.default=a},{"../../types/obstacle":26,"../../utils":30}],18:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.castCorrectTerrain=n.Pond=n.Plain=void 0;const i=e("./plain"),s=e("./pond");var r=e("./plain"),o=(Object.defineProperty(n,"Plain",{enumerable:!0,get:function(){return r.default}}),e("./pond"));Object.defineProperty(n,"Pond",{enumerable:!0,get:function(){return o.default}}),n.castCorrectTerrain=function(e){switch(e.id){case"plain":return new i.default(e);case"pond":return new s.default(e);default:return new i.default(e)}}},{"./plain":19,"./pond":20}],19:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});class i extends e("../../types/terrain").Terrain{constructor(e){super(e),this.color=4286624337}render(e,t,n,i){}renderMap(e,t,n){}}n.default=i},{"../../types/terrain":28}],20:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e("../../types/terrain");const s=e("../../utils");class r extends i.DotTerrain{constructor(e){super(e),this.id="pond",this.color=4281631147}render(e,t,n,i){e=this.position.addVec(e.position.inverse());n.translate(t.width/2+e.x*i,t.height/2+e.y*i),n.fillStyle=this.colorToHex(),(0,s.circleFromCenter)(n,0,0,this.radius*i),n.resetTransform()}renderLayerN1(e,t,n,i){e=this.position.addVec(e.position.inverse());n.translate(t.width/2+e.x*i,t.height/2+e.y*i),n.fillStyle="#905e26",(0,s.circleFromCenter)(n,0,0,1.25*this.radius*i),n.resetTransform()}renderMap(e,t,n){t.fillStyle=this.colorToHex(),(0,s.circleFromCenter)(t,this.position.x*n,this.position.y*n,this.radius*n)}renderMapLayerN1(e,t,n){t.fillStyle="#905e26",(0,s.circleFromCenter)(t,this.position.x*n,this.position.y*n,1.25*this.radius*n)}}n.default=r},{"../../types/terrain":28,"../../utils":30}],21:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const p=e("../../constants"),y=e("../../types/math");var i=e("../../types/weapon");const m=e("../../utils"),f=e("../animations"),g=["left_fist","right_fist"];class s extends i.Weapon{constructor(){super({id:"fists",name:"Fists"})}render(e,t,n,i){var i=i*e.hitbox.radius,s=1.2*i*p.CommonNumber.SIN45,r=y.Vec2.ONE.scaleAll(s),o=[],a=f.animations.get(e.animation.name);if(a){var d=g.indexOf(e.animation.name),c=(a.duration-e.animation.duration)/a.duration;for(let e=0;e<a.keyframes.length-1;e++)if(c>=a.keyframes[e]&&c<=a.keyframes[e+1]){var l=a.positions[e].addVec(a.positions[e+1].addVec(a.positions[e].inverse()).scaleAll((c-a.keyframes[e])/(a.keyframes[e+1]-a.keyframes[e]))).scaleAll(s);o.push(r.addVec(l));break}o.push(r.addVec(r.addAngle(p.CommonAngle.PI_TWO*(2*-d+1))))}else o.push(r.addVec(r.addAngle(p.CommonAngle.PI_TWO))),o.push(r.addVec(r.addAngle(-p.CommonAngle.PI_TWO)));var u=i/3;n.lineWidth=u/3,n.strokeStyle="#000000",n.rotate(2*e.direction.angle());for(const h of o)(0,m.circleFromCenter)(n,h.x,h.y,u,!0,!0)}}n.default=s},{"../../constants":2,"../../types/math":25,"../../types/weapon":29,"../../utils":30,"../animations":9}],22:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.castCorrectWeapon=n.Fists=void 0;const i=e("../../types/weapon"),s=e("./fists");var r=e("./fists");Object.defineProperty(n,"Fists",{enumerable:!0,get:function(){return r.default}}),n.castCorrectWeapon=function(e){return"fists"!==e.id?new i.DummyWeapon(e):new s.default}},{"../../types/weapon":29,"./fists":21}],23:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.DefinedAnimation=void 0;n.DefinedAnimation=class{constructor(e,t,n,i,s){this.id=e,this.positions=t,this.rotations=n,this.keyframes=i,this.duration=s}}},{}],24:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.DummyEntity=n.Entity=n.Inventory=void 0;const i=e("../store/weapons"),s=e("./math");n.Inventory=class{constructor(e){this.holding=(0,i.castCorrectWeapon)(e.holding)}};class r{constructor(e){var t;this.zIndex=0,this.type=e.type,this.position=new s.Vec2(e.position.x,e.position.y),this.direction=new s.Vec2(e.direction.x,e.direction.y),"rect"===e.hitbox.type?(t=e.hitbox,this.hitbox=new s.RectHitbox(t.width,t.height)):(t=e.hitbox,this.hitbox=new s.CircleHitbox(t.radius)),this.animation=e.animation,this.health=this.maxHealth=100,this.despawn=e.despawn}}n.Entity=r;n.DummyEntity=class extends r{render(e,t,n,i){}}},{"../store/weapons":22,"./math":25}],25:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.MovementDirection=n.CircleHitbox=n.RectHitbox=n.Vec2=void 0;class i{constructor(e,t){this.x=e,this.y=t}magnitudeSqr(){return this.x*this.x+this.y*this.y}magnitude(){return Math.sqrt(this.magnitudeSqr())}inverse(){return new i(-this.x,-this.y)}unit(){var e=this.magnitude();return 0===e?i.ZERO:new i(this.x/e,this.y/e)}dot(e){return this.x*e.x+this.y*e.y}angleBetween(e){return Math.acos(this.dot(e)/(this.magnitude()*e.magnitude()))}angle(){var e=Math.acos(this.x/this.magnitude());return 0<this.y?e:-e}addAngle(e){var e=this.angle()+e,t=this.magnitude();return new i(t*Math.cos(e),t*Math.sin(e))}addVec(e){return new i(this.x+e.x,this.y+e.y)}addX(e){return new i(this.x+e,this.y)}addY(e){return new i(this.x,this.y+e)}scale(e,t){return new i(this.x*e,this.y*t)}scaleAll(e){return this.scale(e,e)}render(e,t,n,i,s){s=s.addVec(e.position.inverse());n.translate(t.width/2+s.x*i,t.height/2+s.y*i),n.strokeStyle="#ff0000",n.lineWidth=2,n.beginPath(),n.moveTo(0,0),n.lineTo(this.x*i,this.y*i),n.stroke(),n.resetTransform()}renderPoint(e,t,n,i,s){e=s.addVec(e.position.inverse());n.translate(t.width/2+e.x*i,t.height/2+e.y*i),n.strokeStyle="#ff0000",n.lineWidth=2,n.beginPath(),n.moveTo(0,0),n.lineTo((this.x-s.x)*i,(this.y-s.y)*i),n.stroke(),n.resetTransform()}}(n.Vec2=i).ZERO=new i(0,0),i.ONE=new i(1,0);class s{constructor(e,t){this.type="rect",this.width=e,this.height=t,this.comparable=Math.sqrt(Math.pow(this.width/2,2)+Math.pow(this.height/2,2))}}(n.RectHitbox=s).ZERO=new s(0,0);class r{constructor(e){this.type="circle",this.comparable=this.radius=e}}(n.CircleHitbox=r).ZERO=new r(0),(n=n.MovementDirection||(n.MovementDirection={}))[n.RIGHT=0]="RIGHT",n[n.UP=1]="UP",n[n.LEFT=2]="LEFT",n[n.DOWN=3]="DOWN"},{}],26:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.DummyObstacle=n.Obstacle=void 0;const i=e("./math");class s{constructor(e){var t;this.type="",this.zIndex=0,this.type=e.type,this.position=new i.Vec2(e.position.x,e.position.y),this.direction=new i.Vec2(e.direction.x,e.direction.y),"rect"===e.hitbox.type?(t=e.hitbox,this.hitbox=new i.RectHitbox(t.width,t.height)):(t=e.hitbox,this.hitbox=new i.CircleHitbox(t.radius)),this.despawn=e.despawn}}n.Obstacle=s;n.DummyObstacle=class extends s{render(e,t,n,i){}renderMap(e,t,n){}}},{"./math":25}],27:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.MapPacket=n.GamePacket=n.AckPacket=n.MouseMovePacket=n.MouseReleasePacket=n.MousePressPacket=n.MovementReleasePacket=n.MovementPressPacket=n.PingPacket=void 0;n.PingPacket=class{constructor(){this.type="ping"}};n.MovementPressPacket=class{constructor(e){this.type="movementpress",this.direction=e}};n.MovementReleasePacket=class{constructor(e){this.type="movementrelease",this.direction=e}};n.MousePressPacket=class{constructor(e){this.type="mousepress",this.button=e}};n.MouseReleasePacket=class{constructor(e){this.type="mouserelease",this.button=e}};n.MouseMovePacket=class{constructor(e,t){this.type="mousemove",this.x=e,this.y=t}};n.AckPacket=class{constructor(){this.type="ack"}};n.GamePacket=class{constructor(){this.type="game"}};n.MapPacket=class{constructor(){this.type="map"}}},{}],28:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.DotTerrain=n.Terrain=n.World=void 0;const i=e("../store/terrains"),s=e("./math");n.World=class{constructor(e,t){this.entities=[],this.obstacles=[],this.terrains=[],e=e||s.Vec2.ZERO,this.size=e,t=t||new i.Plain({id:"plain"}),this.defaultTerrain=t}};class r{constructor(e){this.type="generic",this.color=0,this.id=e.id}colorToHex(){return"#"+(16777215&this.color).toString(16)}}n.Terrain=r;n.DotTerrain=class extends r{constructor(e){super(e),this.type="dot",this.position=new s.Vec2(e.position.x,e.position.y),this.radius=e.radius}}},{"../store/terrains":18,"./math":25}],29:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.DummyWeapon=n.Weapon=void 0;class i{constructor(e){this.id=e.id,this.name=e.name}}n.Weapon=i;n.DummyWeapon=class extends i{render(e,t,n,i){}}},{}],30:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.toDegrees=n.roundRect=n.lineBetween=n.circleFromCenter=n.clamp=n.wait=void 0,n.wait=function(t){return new Promise(e=>setTimeout(e,t))},n.clamp=function(e,t,n){return e<t?t:n<e?n:e},n.circleFromCenter=function(e,t,n,i,s=!0,r=!1){e.beginPath(),e.arc(t,n,i,0,2*Math.PI,!1),s&&e.fill(),r&&e.stroke()},n.lineBetween=function(e,t,n,i,s,r=!0){e.beginPath(),e.moveTo(t,n),e.lineTo(i,s),e.closePath(),r&&e.stroke()},n.roundRect=function(e,t,n,i,s,r,o=!0,a=!1){var d,c,l,u;"number"==typeof(r=void 0===r?5:r)?d=c=l=u=r:(d=r.tl||0,c=r.tr||0,u=r.br||0,l=r.bl||0),e.beginPath(),e.moveTo(t+d,n),e.lineTo(t+i-c,n),e.quadraticCurveTo(t+i,n,t+i,n+c),e.lineTo(t+i,n+s-u),e.quadraticCurveTo(t+i,n+s,t+i-u,n+s),e.lineTo(t+l,n+s),e.quadraticCurveTo(t,n+s,t,n+s-l),e.lineTo(t,n+d),e.quadraticCurveTo(t,n,t+d,n),e.closePath(),o&&e.fill(),a&&e.stroke()},n.toDegrees=function(e){return 180*e/Math.PI}},{}]},{},[3]);