!function i(s,o,r){function a(t,e){if(!o[t]){if(!s[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(c)return c(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}n=o[t]={exports:{}},s[t][0].call(n.exports,function(e){return a(s[t][1][e]||e)},n,n.exports,i,s,o,r)}return o[t].exports}for(var c="function"==typeof require&&require,e=0;e<r.length;e++)a(r[e]);return a}({1:[function(e,t,n){t.exports=msgpack},{}],2:[function(e,t,n){"use strict";var i,s;Object.defineProperty(n,"__esModule",{value:!0}),n.CommonNumber=n.CommonAngle=void 0,(s=i=n.CommonAngle||(n.CommonAngle={}))[s.PI_FOUR=Math.PI/4]="PI_FOUR",s[s.PI_TWO=Math.PI/2]="PI_TWO",(s=n.CommonNumber||(n.CommonNumber={}))[s.SIN45=Math.sin(i.PI_FOUR)]="SIN45"},{}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getObjects=n.getEntities=n.getPlayer=n.getSize=n.getId=void 0;const i=e("msgpack-lite");var s,o,r,a=e("./renderer");const c=e("./store/entities"),u=e("./store/objects"),l=e("./types/packets");var d=[],h=[];n.getId=function(){return s},n.getSize=function(){return o},n.getPlayer=function(){return r},n.getEntities=function(){return d},n.getObjects=function(){return h},(0,a.animate)();const p=new WebSocket("ws://localhost:8080");var f=!(p.binaryType="arraybuffer");p.onmessage=e=>{e=(0,i.decode)(new Uint8Array(e.data));s=e.id,o=e.size,p.send((0,i.encode)({id:s}).buffer),f=!0;const t=setInterval(()=>{f?p.send((0,i.encode)(new l.PingPacket).buffer):clearInterval(t)},1e3);p.onmessage=e=>{var t=(0,i.decode)(new Uint8Array(e.data));switch(t.type){case"game":var n=t;d=n.entities.map(e=>(0,c.castCorrectEntity)(e)),h=n.objects.map(e=>(0,u.castCorrectObject)(e)),r=new c.Player(n.player);break;case"map":}}},p.onclose=()=>f=!1;const y=["d","w","a","s"],m=[!1,!1,!1,!1];window.onkeydown=e=>{f&&0<=(e=y.indexOf(e.key))&&!m[e]&&(p.send((0,i.encode)(new l.MovementPressPacket(e)).buffer),m[e]=!0)},window.onkeyup=e=>{f&&0<=(e=y.indexOf(e.key))&&(p.send((0,i.encode)(new l.MovementReleasePacket(e)).buffer),m[e]=!1)},window.onmousemove=e=>{f&&p.send((0,i.encode)(new l.MouseMovePacket(e.x-window.innerWidth/2,e.y-window.innerHeight/2)).buffer)},window.onmousedown=e=>{f&&p.send((0,i.encode)(new l.MousePressPacket(e.button)))},window.onmouseup=e=>{f&&p.send((0,i.encode)(new l.MouseReleasePacket(e.button)))}},{"./renderer":4,"./store/entities":9,"./store/objects":12,"./types/packets":20,"msgpack-lite":1}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.animate=void 0;const s=e("./game"),o=e("./rendering/hud"),r=e("./utils"),a=document.getElementById("game"),c=(a.width=window.innerWidth,a.height=window.innerHeight,window.onresize=()=>{a.width=window.innerWidth,a.height=window.innerHeight},a.getContext("2d"));n.animate=function e(){try{c.fillStyle="#80B251",c.fillRect(0,0,a.width,a.height);const n=(0,s.getPlayer)();if(n){const i=Math.max(a.width,a.height)/(40*n.scope);c.strokeStyle="#000000",c.lineWidth=a.width/200;var t=(0,s.getSize)();c.strokeRect(a.width/2-(n.position.x+n.hitbox.comparable())*i,a.height/2-(n.position.y+n.hitbox.comparable())*i,(t[0]+2*n.hitbox.comparable())*i,(t[1]+2*n.hitbox.comparable())*i),c.lineWidth/=2,c.globalAlpha=.2;for(let e=0;e<=t[0];e+=20)(0,r.lineBetween)(c,a.width/2-(n.position.x-e)*i,0,a.width/2-(n.position.x-e)*i,a.height);for(let e=0;e<=t[1];e+=20)(0,r.lineBetween)(c,0,a.height/2-(n.position.y-e)*i,a.width,a.height/2-(n.position.y-e)*i);c.globalAlpha=1,n.render(n,a,c,i),(0,s.getEntities)().forEach(e=>{e.render(n,a,c,i)}),(0,s.getObjects)().forEach(e=>{e.render(n,a,c,i)}),(0,o.drawHealth)(n,a,c)}}catch(e){console.error(e)}requestAnimationFrame(e)}},{"./game":3,"./rendering/hud":5,"./utils":22}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.drawHealth=void 0;const c=e("../utils");n.drawHealth=function(e,t,n){var i=t.width/4,s=t.height/20,o=Math.min(t.width,t.height)/100,r=i-2*o,a=s-2*o;n.fillStyle="#000000",n.globalAlpha=.2,(0,c.roundRect)(n,(t.width-i)/2,t.height-s-o,i,s,o/2),e.health==e.maxHealth?n.fillStyle="#ccc":e.health/e.maxHealth<.8?n.fillStyle="#fdd":e.health/e.maxHealth<.25?n.fillStyle="#daa":n.fillStyle="#fff",n.globalAlpha=1,(0,c.roundRect)(n,(t.width-r)/2,t.height-s,r*e.health/e.maxHealth,a,o/2)}},{"../utils":22}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e("../../types/animations"),e=e("../../types/maths");const s=new i.DefinedAnimation("left_fist",[new e.Vec2(0,-1),e.Vec2.ONE,new e.Vec2(0,-1)],Array(3).fill(e.Vec2.ZERO),[0,.5,1],50),o=new i.DefinedAnimation("right_fist",[new e.Vec2(0,1),e.Vec2.ONE,new e.Vec2(0,1)],Array(3).fill(e.Vec2.ZERO),[0,.5,1],50);n.default=function(e){e.set(s.id,s),e.set(o.id,o)}},{"../../types/animations":16,"../../types/maths":18}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.animations=void 0;e=e("./fists");n.animations=new Map,(0,e.default)(n.animations)},{"./fists":6}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});class i extends e("../../types/entities").Entity{constructor(e){super(e),this.type="bullet",this.dmg=e.dmg}}n.default=i},{"../../types/entities":17}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.castCorrectEntity=n.Bullet=n.Player=void 0;const i=e("../../types/entities"),s=e("./bullet"),o=e("./player");var r=e("./player"),a=(Object.defineProperty(n,"Player",{enumerable:!0,get:function(){return r.default}}),e("./bullet"));Object.defineProperty(n,"Bullet",{enumerable:!0,get:function(){return a.default}}),n.castCorrectEntity=function(e){switch(e.type){case"player":return new o.default(e);case"bullet":return new s.default(e);default:return new i.Entity(e)}}},{"../../types/entities":17,"./bullet":8,"./player":10}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const i=e("../../types/entities"),o=e("../../utils"),r=e("../weapons");class s extends i.Entity{constructor(e){super(e),this.type="player",this.id=e.id,this.boost=e.boost,this.scope=e.scope,"number"==typeof e.inventory.holding?this.inventory=e.inventory.weapons[e.inventory.holding]:this.inventory=new i.Inventory(e.inventory)}render(e,t,n,i){var e=this.position.addVec(e.position.inverse()),s=i*this.hitbox.radius;n.fillStyle="#F8C675",(0,o.circleFromCenter)(n,t.width/2+e.x*i,t.height/2+e.y*i,s),console.log(this.inventory.holding),(this.inventory.holding||new r.Fists).render(this,e,t,n,i)}}n.default=s},{"../../types/entities":17,"../../utils":22,"../weapons":15}],11:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});e=e("../../types/objects");const a=Object.assign(new Image,{loaded:!1});a.onload=()=>a.loaded=!0,a.src="assets/images/Bush.png";class i extends e.GameObject{constructor(){super(...arguments),this.type="bush"}render(e,t,n,i){var s,o,r;a.loaded&&(e=this.position.addVec(e.position.inverse()),o=(s=i*this.hitbox.comparable()*3)*a.naturalWidth/a.naturalHeight,r=(t.width-s)/4+e.x*i,t=(t.height-o)/4+e.y*i,n.drawImage(a,r,t,s,o))}}n.default=i},{"../../types/objects":19}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.castCorrectObject=n.Bush=n.Tree=void 0;const i=e("../../types/objects"),s=e("./bush"),o=e("./tree");var r=e("./tree"),a=(Object.defineProperty(n,"Tree",{enumerable:!0,get:function(){return r.default}}),e("./bush"));Object.defineProperty(n,"Bush",{enumerable:!0,get:function(){return a.default}}),n.castCorrectObject=function(e){switch(e.type){case"tree":return new o.default(e);case"bush":return new s.default(e);default:return new i.GameObject(e)}}},{"../../types/objects":19,"./bush":11,"./tree":13}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});e=e("../../types/objects");const a=Object.assign(new Image,{loaded:!1});a.onload=()=>a.loaded=!0,a.src="assets/images/tree.svg";class i extends e.GameObject{constructor(){super(...arguments),this.type="tree"}render(e,t,n,i){var s,o,r;a.loaded&&(e=this.position.addVec(e.position.inverse()),o=(s=i*this.hitbox.comparable()*10)*a.naturalWidth/a.naturalHeight,r=(t.width-s)/2+e.x*i,t=(t.height-o)/2+e.y*i,n.drawImage(a,r,t,s,o))}}n.default=i},{"../../types/objects":19}],14:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const f=e("../../constants"),y=e("../../types/maths");var i=e("../../types/weapons");const m=e("../../utils"),b=e("../animations"),g=["left_fist","right_fist"];class s extends i.Weapon{constructor(){super({id:"fists",name:"Fists"})}render(t,e,n,i,s){var s=s*t.hitbox.radius,o=1.2*s*f.CommonNumber.SIN45,r=y.Vec2.ONE.scaleAll(o),a=[],c=b.animations.get(t.animation.name);if(c){var u=g.indexOf(t.animation.name),l=(c.duration-t.animation.duration)/c.duration;for(let e=0;e<c.keyframes.length-1;e++)if(l>=c.keyframes[e]&&l<=c.keyframes[e+1]){var d=c.positions[e].addVec(c.positions[e+1].addVec(c.positions[e].inverse()).scaleAll((l-c.keyframes[e])/(c.keyframes[e+1]-c.keyframes[e]))).scaleAll(o);a.push(r.addVec(d).addAngle(t.direction.angle()));break}a.push(r.addVec(r.addAngle(f.CommonAngle.PI_TWO*(2*-u+1))).addAngle(t.direction.angle()))}else a.push(r.addVec(r.addAngle(f.CommonAngle.PI_TWO)).addAngle(t.direction.angle())),a.push(r.addVec(r.addAngle(-f.CommonAngle.PI_TWO)).addAngle(t.direction.angle()));var h=s/3;i.lineWidth=h/3,i.strokeStyle="#000000";for(const p of a)(0,m.circleFromCenter)(i,n.width/2+e.x*o+p.x,n.height/2+e.y*o+p.y,h,!0,!0)}}n.default=s},{"../../constants":2,"../../types/maths":18,"../../types/weapons":21,"../../utils":22,"../animations":7}],15:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.castCorrectWeapon=n.Fists=void 0;const i=e("../../types/weapons"),s=e("./fists");var o=e("./fists");Object.defineProperty(n,"Fists",{enumerable:!0,get:function(){return o.default}}),n.castCorrectWeapon=function(e){return"fists"!==e.id?new i.Weapon(e):new s.default}},{"../../types/weapons":21,"./fists":14}],16:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.DefinedAnimation=void 0;n.DefinedAnimation=class{constructor(e,t,n,i,s){this.id=e,this.positions=t,this.rotations=n,this.keyframes=i,this.duration=s}}},{}],17:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Entity=n.Inventory=void 0;const i=e("../store/weapons"),s=e("./maths");n.Inventory=class{constructor(e){this.holding=(0,i.castCorrectWeapon)(e.holding)}};n.Entity=class{constructor(e){var t;this.type=e.type,this.position=new s.Vec2(e.position.x,e.position.y),this.direction=new s.Vec2(e.direction.x,e.direction.y),"rect"===e.hitbox.type?(t=e.hitbox,this.hitbox=new s.RectHitbox(t.width,t.height)):(t=e.hitbox,this.hitbox=new s.CircleHitbox(t.radius)),this.animation=e.animation,this.health=this.maxHealth=100}render(e,t,n,i){}}},{"../store/weapons":15,"./maths":18}],18:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.MovementDirection=n.CircleHitbox=n.RectHitbox=n.Vec2=void 0;class i{constructor(e,t){this.x=e,this.y=t}magnitudeSqr(){return this.x*this.x+this.y*this.y}magnitude(){return Math.sqrt(this.magnitudeSqr())}inverse(){return new i(-this.x,-this.y)}unit(){var e=this.magnitude();return 0===e?i.ZERO:new i(this.x/e,this.y/e)}dot(e){return this.x*e.x+this.y*e.y}angleBetween(e){return Math.acos(this.dot(e)/(this.magnitude()*e.magnitude()))}angle(){var e=Math.acos(this.x/this.magnitude());return 0<this.y?e:-e}addAngle(e){var e=this.angle()+e,t=this.magnitude();return new i(t*Math.cos(e),t*Math.sin(e))}addVec(e){return new i(this.x+e.x,this.y+e.y)}addX(e){return new i(this.x+e,this.y)}addY(e){return new i(this.x,this.y+e)}scale(e,t){return new i(this.x*e,this.y*t)}scaleAll(e){return this.scale(e,e)}}(n.Vec2=i).ZERO=new i(0,0),i.ONE=new i(1,0);class s{constructor(e,t){this.type="rect",this.width=e,this.height=t}comparable(){return this.width}}(n.RectHitbox=s).ZERO=new s(0,0);class o{constructor(e){this.type="circle",this.radius=e}comparable(){return this.radius}}(n.CircleHitbox=o).ZERO=new o(0),(n=n.MovementDirection||(n.MovementDirection={}))[n.RIGHT=0]="RIGHT",n[n.UP=1]="UP",n[n.LEFT=2]="LEFT",n[n.DOWN=3]="DOWN"},{}],19:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.GameObject=void 0;const i=e("./maths");n.GameObject=class{constructor(e){var t;this.type="",this.type=e.type,this.position=new i.Vec2(e.position.x,e.position.y),"rect"===e.hitbox.type?(t=e.hitbox,this.hitbox=new i.RectHitbox(t.width,t.height)):(t=e.hitbox,this.hitbox=new i.CircleHitbox(t.radius))}render(e,t,n,i){}}},{"./maths":18}],20:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.MapPacket=n.GamePacket=n.MouseMovePacket=n.MouseReleasePacket=n.MousePressPacket=n.MovementReleasePacket=n.MovementPressPacket=n.PingPacket=void 0;n.PingPacket=class{constructor(){this.type="ping"}};n.MovementPressPacket=class{constructor(e){this.type="movementpress",this.direction=e}};n.MovementReleasePacket=class{constructor(e){this.type="movementrelease",this.direction=e}};n.MousePressPacket=class{constructor(e){this.type="mousepress",this.button=e}};n.MouseReleasePacket=class{constructor(e){this.type="mouserelease",this.button=e}};n.MouseMovePacket=class{constructor(e,t){this.type="mousemove",this.x=e,this.y=t}};n.GamePacket=class{constructor(){this.type="game"}};n.MapPacket=class{constructor(){this.type="map"}}},{}],21:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Weapon=void 0;n.Weapon=class{constructor(e){this.id=e.id,this.name=e.name}render(e,t,n,i,s){}}},{}],22:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.toDegrees=n.roundRect=n.lineBetween=n.circleFromCenter=n.circle=n.clamp=n.wait=void 0,n.wait=function(t){return new Promise(e=>setTimeout(e,t))},n.clamp=function(e,t,n){return e<t?t:n<e?n:e},n.circle=function(e,t,n,i,s=!0,o=!1){e.beginPath(),e.arc(t+i,n+i,i,0,2*Math.PI,!1),s&&e.fill(),o&&e.stroke()},n.circleFromCenter=function(e,t,n,i,s=!0,o=!1){e.beginPath(),e.arc(t,n,i,0,2*Math.PI,!1),s&&e.fill(),o&&e.stroke()},n.lineBetween=function(e,t,n,i,s,o=!0){e.beginPath(),e.moveTo(t,n),e.lineTo(i,s),e.closePath(),o&&e.stroke()},n.roundRect=function(e,t,n,i,s,o,r=!0,a=!1){var c,u,l,d;"number"==typeof(o=void 0===o?5:o)?c=u=l=d=o:(c=o.tl||0,u=o.tr||0,d=o.br||0,l=o.bl||0),e.beginPath(),e.moveTo(t+c,n),e.lineTo(t+i-u,n),e.quadraticCurveTo(t+i,n,t+i,n+u),e.lineTo(t+i,n+s-d),e.quadraticCurveTo(t+i,n+s,t+i-d,n+s),e.lineTo(t+l,n+s),e.quadraticCurveTo(t,n+s,t,n+s-l),e.lineTo(t,n+c),e.quadraticCurveTo(t,n,t+c,n),e.closePath(),r&&e.fill(),a&&e.stroke()},n.toDegrees=function(e){return 180*e/Math.PI}},{}]},{},[3]);